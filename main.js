!function(){"use strict";class e{constructor(e,t,s,r,i,n){this._name=e.name,this._link=e.link,this._id=e._id,this._ownerId=e.owner._id,this._likes=e.likes,this._userId=t,this._cardSelector=s,this._handleCardClick=r,this._handleDeleteClick=i,this._handleLikeClick=n}deleteCard(){this._cardElement.remove(),this._cardElement=null}addLikes(){this._likeBtn.classList.add("card__like-button_active")}removeLikes(){this._likeBtn.classList.remove("card__like-button_active")}updateLikes(e){this._cardLike.textContent=e.likes.length}isLiked(){return!!this._likeBtn.classList.contains("card__like-button_active")}_setEventListeners(){this._likeBtn=this._cardElement.querySelector(".card__like-button"),this._deleteBtn=this._cardElement.querySelector(".card__delete-button"),this._likeBtn.addEventListener("click",(()=>{this._handleLikeClick(this._id)})),this._deleteBtn.addEventListener("click",(()=>{this._handleDeleteClick(this._id)})),this._cardImgElement.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}_getElement(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getCardElement(){return this._cardElement=this._getElement(),this._cardImgElement=this._cardElement.querySelector(".card__image"),this._titleElement=this._cardElement.querySelector(".card__title"),this._cardLike=this._cardElement.querySelector(".card__like-number"),this._cardLike.textContent=this._likes.length,this._setEventListeners(),this._userId!=this._ownerId&&this._deleteBtn.remove(),this._cardImgElement.src=this._link,this._cardImgElement.alt=this._name,this._titleElement.textContent=this._name,this._cardElement}}class t{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitBtnSelector=e.submitButtonSelector,this._inactiveBtnClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formELement=t}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(e){return e.validity.valid}_setFormEventListeners(){this._inputElements=[...this._formELement.querySelectorAll(this._inputSelector)],this._submitBtn=this._formELement.querySelector(this._submitBtnSelector),this.toggleButtonState(),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}_disableButton(){this._submitBtn.classList.add(this._inactiveBtnClass),this._submitBtn.disabled=!0}_enableButton(){this._submitBtn.classList.remove(this._inactiveBtnClass),this._submitBtn.disabled=!1}toggleButtonState(){this._inputElements.every(this._hasInvalidInput)?this._enableButton():this._disableButton()}_showInputError(e){const t=this._formELement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formELement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}enableValidation(){this._formElements=[...document.querySelectorAll(this._formSelector)],this._formElements.forEach((e=>{e.addEventListener("submit",(e=>{e.preventDefault()})),this._setFormEventListeners()}))}}const s={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input-error",errorClass:"modal__error_visible"},r=document.querySelector("#profile-edit-modal"),i=r.querySelector(".modal__form"),n=document.querySelector("#card-add-modal"),o=n.querySelector(".modal__form"),a=(document.querySelector(".cards__list"),document.querySelector("#image-modal")),l=document.querySelector("#delete-modal"),d=document.querySelector("#avatar-modal"),c=d.querySelector("#avatar-modal-form"),h=document.querySelector(".profile__edit"),_=r.querySelector(".modal__close"),u=document.querySelector(".profile__add"),m=n.querySelector(".modal__close"),E=document.querySelector(".profile__title"),p=document.querySelector(".profile__description"),S=document.querySelector(".profile__image"),v=a.querySelector(".modal__close"),k=l.querySelector(".modal__close"),L=document.querySelector(".profile__avatar-edit-btn"),f=d.querySelector(".modal__close"),b=document.querySelector("#title-input"),y=document.querySelector("#description-input");document.querySelector("#card-title-input"),document.querySelector("#url-input");var C=class{constructor(e){let{modalSelector:t}=e;this._modalElement=t}open(){this._modalElement.classList.add("modal__opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modalElement.classList.remove("modal__opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{27===e.which&&this.close()};_handleOverlayClose(e){e.target.classList.contains("modal__opened")&&this.close()}setEventListeners(){this._modalElement.querySelector(".modal__close").addEventListener("click",(()=>this.close())),this._modalElement.addEventListener("mousedown",(e=>this._handleOverlayClose(e)))}},g=class extends C{constructor(e,t){super({modalSelector:e}),this._modalForm=this._modalElement.querySelector(".modal__form"),this._modalSubmitBtn=this._modalElement.querySelector(".modal__button"),this._modalInputs=this._modalElement.querySelectorAll(".modal__input"),this._handleSubmitForm=t}_getInputValues(){const e={};return this._modalInputs.forEach((t=>{e[t.name]=t.value})),e}uxUpload(e,t){this._modalSubmitBtn.textContent=t}setEventListeners(){this._modalSubmitBtn.addEventListener("click",(e=>{e.preventDefault(),this._handleSubmitForm(this._getInputValues()),this.close()})),super.setEventListeners()}close(){this._modalForm.reset(),super.close()}};const q=new class{constructor(e){let{name:t,about:s,avatar:r}=e;this._user=t,this._about=s,this._avatar=r}getUserInfo(){return{name:this._user.textContent,about:this._about.textContent,avatar:this._avatar}}setUserInfo(e){let{name:t,about:s,avatar:r}=e;this._user.textContent=t,this._about.textContent=s,this._avatar.src=r,this._avatar.alt=t}}({name:E,about:p,avatar:S});let I;const B=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkStatus(e){if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then((e=>this._checkStatus(e)))}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then((e=>this._checkStatus(e)))}editUserProfile(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.title,about:e.description})}).then((e=>this._checkStatus(e)))}editUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>this._checkStatus(e)))}addNewCard(e){let{name:t,link:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then((e=>this._checkStatus(e)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>this._checkStatus(e)))}addCardLike(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"PUT",headers:this._headers}).then((e=>this._checkStatus(e)))}removeCardLike(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"DELETE",headers:this._headers}).then((e=>this._checkStatus(e)))}getApiInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"c7546df9-ad4c-4c05-9963-4c89159dd0ba","Content-Type":"application/json"}});let U;const x=new g(r,(e=>{x.uxUpload(!0,"Saving..."),B.editUserProfile(e).then((e=>{q.setUserInfo(e),x.close()})).catch((e=>console.error(e))).finally((()=>{x.uxUpload(!1,"Save")}))})),w=new g(n,(e=>{w.uxUpload(!0,"Creating..."),B.addNewCard(e).then((e=>{T(e),w.close()})).catch((e=>console.error(e))).finally((()=>{w.uxUpload(!1,"Create")}))})),$=new class extends C{constructor(e){let{modalSelector:t}=e;super({modalSelector:t}),this._modalImage=this._modalElement.querySelector(".modal__image"),this._modalCaption=this._modalElement.querySelector(".modal__caption")}open(e,t){this._modalImage.src=t,this._modalImage.alt=e,this._modalCaption.textContent=e,super.open()}}({modalSelector:a}),A=new class extends C{constructor(e){super({modalSelector:e}),this._confirmButton=this._modalElement.querySelector("#delete-btn-submit")}submitAction(e){this._handleSubmit=e}confirmDelete(e,t){this._confirmButton.textContent=e?"Deleting...":t}setEventListeners(){super.setEventListeners(),this._confirmButton.addEventListener("click",(e=>{e.preventDefault(),this._handleSubmit()}))}}(l),D=new g(d,(e=>{D.uxUpload(!0,"Saving..."),B.editUserAvatar(e.avatar).then((e=>{q.setUserInfo(e),D.close()})).catch((e=>console.error(e))).finally((()=>{D.uxUpload(!1,"Save")}))}));function T(t){const s=function(t){const s=new e(t,I,"#card-template",((e,t)=>{$.open(e,t)}),(e=>{A.open(),A.submitAction((()=>{A.confirmDelete(!0),B.deleteCard(e).then((()=>{s.deleteCard(),A.close()})).catch((e=>console.error(e))).finally((()=>{A.confirmDelete(!1,"Yes")}))}))}),(e=>{s.isLiked()?B.removeCardLike(e).then((e=>{s.removeLikes(),s.updateLikes(e)})).catch((e=>console.error(e))):B.addCardLike(e).then((e=>{s.addLikes(),s.updateLikes(e)})).catch((e=>console.error(e)))}));return s.getCardElement()}(t);U.prependItem(s)}B.getApiInfo().then((e=>{let[t,s]=e;I=t._id,q.setUserInfo(t),U=new class{constructor(e,t){let{item:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.append(e)}prependItem(e){this._container.prepend(e)}}({item:s,renderer:T},".cards__list"),U.renderItems()})).catch((e=>console.error(e))),h.addEventListener("click",(()=>{b.value=E.textContent,y.value=p.textContent,x.open()})),u.addEventListener("click",(()=>{w.open(),V.toggleButtonState()})),L.addEventListener("click",(()=>{D.open(),F.toggleButtonState()})),_.addEventListener("click",(()=>x.close())),m.addEventListener("click",(()=>w.close())),v.addEventListener("click",(()=>$.close())),k.addEventListener("click",(()=>A.close())),f.addEventListener("click",(()=>D.close())),x.setEventListeners(),w.setEventListeners(),$.setEventListeners(),A.setEventListeners(),D.setEventListeners();const P=new t(s,i),V=new t(s,o),F=new t(s,c);P.enableValidation(),V.enableValidation(),F.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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L0QsTUFBTSxJQUV6QmQsRUFBVzdELGlCQUFpQixTQUFTLEtBQ25DaUosRUFBYXRFLE9BQ2JxRyxFQUFxQjNJLG1CQUFtQixJQUcxQytCLEVBQWlCcEUsaUJBQWlCLFNBQVMsS0FDekM4SixFQUFrQm5GLE9BQ2xCc0csRUFBb0I1SSxtQkFBbUIsSUFJekN1QixFQUF5QjVELGlCQUFpQixTQUFTLElBQ2pEMEksRUFBaUI3RCxVQUduQmYsRUFBaUI5RCxpQkFBaUIsU0FBUyxJQUFNaUosRUFBYXBFLFVBRTlEWCxFQUFxQmxFLGlCQUFpQixTQUFTLElBQU1tSixFQUFhdEUsVUFFbEVWLEVBQW1CbkUsaUJBQWlCLFNBQVMsSUFBTXNKLEVBQWdCekUsVUFFbkVSLEVBQW9CckUsaUJBQWlCLFNBQVMsSUFBTThKLEVBQWtCakYsVUFHdEU2RCxFQUFpQnhELG9CQUNqQitELEVBQWEvRCxvQkFDYmlFLEVBQWFqRSxvQkFDYm9FLEVBQWdCcEUsb0JBQ2hCNEUsRUFBa0I1RSxvQkFHbEIsTUFBTWdHLEVBQXVCLElBQUl4SyxFQUFjQyxFQUFReUMsR0FDakQ0SCxFQUF1QixJQUFJdEssRUFBY0MsRUFBUTJDLEdBQ2pEMkgsRUFBc0IsSUFBSXZLLEVBQWNDLEVBQVErQyxHQUV0RHdILEVBQXFCbkksbUJBQ3JCaUksRUFBcUJqSSxtQkFDckJrSSxFQUFvQmxJLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvQXBpLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiAgICAgICAgICAgQ2FyZCBDbGFzcyAgICAgICAgICAgICovXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIHVzZXJJZCxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUNhcmRDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxyXG4gICAgaGFuZGxlTGlrZUNsaWNrXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XHJcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xyXG4gIH1cclxuXHJcbiAgLyogICAgICAgICAgICBIYW5kbGVycyAgICAgICAgICAgICAqL1xyXG4gIC8vIF9oYW5kbGVMaWtlQnV0dG9uKCkge1xyXG4gIC8vICAgdGhpcy5fbGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIC8vIH1cclxuXHJcbiAgZGVsZXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgYWRkTGlrZXMoKSB7XHJcbiAgICB0aGlzLl9saWtlQnRuLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICByZW1vdmVMaWtlcygpIHtcclxuICAgIHRoaXMuX2xpa2VCdG4uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUxpa2VzKGRhdGEpIHtcclxuICAgIHRoaXMuX2NhcmRMaWtlLnRleHRDb250ZW50ID0gZGF0YS5saWtlcy5sZW5ndGg7XHJcbiAgfVxyXG5cclxuICBpc0xpa2VkKCkge1xyXG4gICAgaWYgKHRoaXMuX2xpa2VCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyogICAgICAgICAgICAgRXZlbnQgTGlzdGVuZXJzICAgICAgICAgICAgICovXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ0biA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9kZWxldGVCdG4gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcblxyXG4gICAgdGhpcy5fbGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcy5faWQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMuX2lkKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWdFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyogICAgICBDYXJkIFRlbXBsYXRlICAgICAgICovXHJcbiAgX2dldEVsZW1lbnQoKSB7XHJcbiAgICByZXR1cm4gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICB9XHJcblxyXG4gIC8qICAgICAgICAgICAgIENhcmQgVmlldyAgICAgICAgICAgKi9cclxuICBnZXRDYXJkRWxlbWVudCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0RWxlbWVudCgpO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWdFbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX3RpdGxlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICB0aGlzLl9jYXJkTGlrZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1udW1iZXJcIik7XHJcblxyXG4gICAgdGhpcy5fY2FyZExpa2UudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICBpZiAodGhpcy5fdXNlcklkICE9IHRoaXMuX293bmVySWQpIHtcclxuICAgICAgdGhpcy5fZGVsZXRlQnRuLnJlbW92ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX2NhcmRJbWdFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9jYXJkSW1nRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fdGl0bGVFbGVtZW50LnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiLyogICAgICBGb3JtIFZhbGlkYXRvciBDbGFzcyAgICAgICovXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IGNvbmZpZy5mb3JtU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdG5TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnRuQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9mb3JtRUxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgLyogICAgICBDaGVjayBWYWxpZGl0eSAgICAgICovXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dChpbnB1dEVsZW1lbnQpIHtcclxuICAgIHJldHVybiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgfVxyXG5cclxuICAvKiBGb3JtIEV2ZW50IExpc3RlbmVycyAqL1xyXG4gIF9zZXRGb3JtRXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gW1xyXG4gICAgICAuLi50aGlzLl9mb3JtRUxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpLFxyXG4gICAgXTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ0biA9IHRoaXMuX2Zvcm1FTGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnRuU2VsZWN0b3IpO1xyXG5cclxuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qICAgICAgIEVuYWJsZS9EaXNhYmxlIEJ1dHRvbnMgICAgICAqL1xyXG4gIF9kaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnRuLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdG5DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdG4uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgX2VuYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ0bi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnRuQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnRuLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvKiAgICAgICBUb2dnbGUgQnV0dG9uIFN0YXRlICAgICAgICovXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAoIXRoaXMuX2lucHV0RWxlbWVudHMuZXZlcnkodGhpcy5faGFzSW52YWxpZElucHV0KSkge1xyXG4gICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qICAgICAgRXZlbnQgSGFuZGxlcnMgICAgICAgKi9cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRUxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRUxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgLyogICAgICAgRW5hYmxlIEZvcm0gVmFsaWRhdGlvbiAgICAgICAqL1xyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudHMgPSBbLi4uZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9mb3JtU2VsZWN0b3IpXTtcclxuXHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudHMuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgICAgZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgfSk7XHJcbiAgICAgIHRoaXMuX3NldEZvcm1FdmVudExpc3RlbmVycygpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsIi8qICAgICAgSW5pdGlhbCBDYXJkcyBPYmplY3QgICAgICAqL1xyXG5leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbi8qICAgICAgQ29uZmlnIE9iamVjdCAgICAgICAqL1xyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcblxyXG4vKiAgICAgIFdyYXBwZXJzICAgICAgKi9cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1hZGQtbW9kYWxcIik7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybSA9IGFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5leHBvcnQgY29uc3QgY2FyZExpc3RFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZS1tb2RhbFwiKTtcclxuZXhwb3J0IGNvbnN0IHJlbW92ZUNhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLW1vZGFsXCIpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1tb2RhbFwiKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhck1vZGFsRm9ybSA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsLWZvcm1cIik7XHJcblxyXG4vKiAgICAgIEJ1dHRvbnMgYW5kIERPTSBlbGVtZW50cyAgICAgICovXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdFwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWxDbG9zZUJ0biA9XHJcbiAgcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZFwiKTtcclxuZXhwb3J0IGNvbnN0IGFkZE1vZGFsQ2xvc2VCdG4gPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcclxuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZUNsb3NlQnRuID1cclxuICBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmRDbG9zZUJ0biA9XHJcbiAgcmVtb3ZlQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fYXZhdGFyLWVkaXQtYnRuXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhck1vZGFsQ2xvc2VCdG4gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuXHJcbi8qICAgICAgIEZvcm0gSW5wdXRzICAgICAgKi9cclxuZXhwb3J0IGNvbnN0IG1vZGFsVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3RpdGxlLWlucHV0XCIpO1xyXG5leHBvcnQgY29uc3QgbW9kYWxEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVzY3JpcHRpb24taW5wdXRcIik7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGl0bGUtaW5wdXRcIik7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3VybC1pbnB1dFwiKTtcclxuXHJcbi8qICAgICAgICAgIEtleWNvZGVzICAgICAgICAgICAgICovXHJcbmV4cG9ydCBjb25zdCBFU0NfS0VZQ09ERSA9IDI3O1xyXG4iLCJpbXBvcnQgeyBFU0NfS0VZQ09ERSB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IG1vZGFsU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50ID0gbW9kYWxTZWxlY3RvcjtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChlKSA9PiB7XHJcbiAgICBpZiAoZS53aGljaCA9PT0gRVNDX0tFWUNPREUpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIF9oYW5kbGVPdmVybGF5Q2xvc2UoZSkge1xyXG4gICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19vcGVuZWRcIikpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5jbG9zZSgpKTtcclxuXHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZSkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlT3ZlcmxheUNsb3NlKGUpXHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXA7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yLCBoYW5kbGVTdWJtaXRGb3JtKSB7XHJcbiAgICBzdXBlcih7IG1vZGFsU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9tb2RhbEZvcm0gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX21vZGFsU3VibWl0QnRuID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX21vZGFsSW5wdXRzID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0Rm9ybSA9IGhhbmRsZVN1Ym1pdEZvcm07XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG4gICAgdGhpcy5fbW9kYWxJbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgdXhVcGxvYWQoaXNVcGxvYWQsIHVwbG9hZCkge1xyXG4gICAgaWYgKGlzVXBsb2FkKSB7XHJcbiAgICAgIHRoaXMuX21vZGFsU3VibWl0QnRuLnRleHRDb250ZW50ID0gdXBsb2FkO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fbW9kYWxTdWJtaXRCdG4udGV4dENvbnRlbnQgPSB1cGxvYWQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX21vZGFsU3VibWl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZvcm0odGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fbW9kYWxGb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoRm9ybTtcclxuIiwiLyogICAgICAgSW1wb3J0cyAgICAgICAqL1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5cclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuXHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3V0aWxzL0FwaS5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGNvbmZpZyxcclxuICBwcm9maWxlRWRpdE1vZGFsLFxyXG4gIHByb2ZpbGVFZGl0Rm9ybSxcclxuICBhZGRDYXJkTW9kYWwsXHJcbiAgYWRkQ2FyZEZvcm0sXHJcbiAgcHJvZmlsZUVkaXRCdG4sXHJcbiAgcHJvZmlsZUVkaXRNb2RhbENsb3NlQnRuLFxyXG4gIGFkZENhcmRCdG4sXHJcbiAgYWRkTW9kYWxDbG9zZUJ0bixcclxuICBwcmV2aWV3SW1hZ2VNb2RhbCxcclxuICBwcmV2aWV3SW1hZ2VDbG9zZUJ0bixcclxuICBtb2RhbFRpdGxlLFxyXG4gIG1vZGFsRGVzY3JpcHRpb24sXHJcbiAgcHJvZmlsZVRpdGxlLFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbixcclxuICByZW1vdmVDYXJkTW9kYWwsXHJcbiAgZGVsZXRlQ2FyZENsb3NlQnRuLFxyXG4gIHByb2ZpbGVBdmF0YXIsXHJcbiAgYXZhdGFyTW9kYWwsXHJcbiAgYXZhdGFyRWRpdEJ1dHRvbixcclxuICBhdmF0YXJNb2RhbENsb3NlQnRuLFxyXG4gIGF2YXRhck1vZGFsRm9ybSxcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG4vKiAgICAgICBVc2VyIEluZm8gICAgICAgKi9cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWU6IHByb2ZpbGVUaXRsZSxcclxuICBhYm91dDogcHJvZmlsZURlc2NyaXB0aW9uLFxyXG4gIGF2YXRhcjogcHJvZmlsZUF2YXRhcixcclxufSk7XHJcbmxldCB1c2VySWQ7XHJcblxyXG4vKiAgICAgICBBUElzICAgICAgKi9cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJjNzU0NmRmOS1hZDRjLTRjMDUtOTk2My00Yzg5MTU5ZGQwYmFcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5sZXQgY2FyZEFwaTtcclxuXHJcbi8qICAgICAgIFBvcHVwcyAgICAgICovXHJcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShwcm9maWxlRWRpdE1vZGFsLCAoaW5wdXQpID0+IHtcclxuICBlZGl0UHJvZmlsZU1vZGFsLnV4VXBsb2FkKHRydWUsIFwiU2F2aW5nLi4uXCIpO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRVc2VyUHJvZmlsZShpbnB1dClcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xyXG4gICAgICBlZGl0UHJvZmlsZU1vZGFsLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgZWRpdFByb2ZpbGVNb2RhbC51eFVwbG9hZChmYWxzZSwgXCJTYXZlXCIpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuY29uc3QgY2FyZEFkZE1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oYWRkQ2FyZE1vZGFsLCAoaW5wdXQpID0+IHtcclxuICBjYXJkQWRkTW9kYWwudXhVcGxvYWQodHJ1ZSwgXCJDcmVhdGluZy4uLlwiKTtcclxuICBhcGlcclxuICAgIC5hZGROZXdDYXJkKGlucHV0KVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgcmVuZGVyQ2FyZChkYXRhKTtcclxuICAgICAgY2FyZEFkZE1vZGFsLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgY2FyZEFkZE1vZGFsLnV4VXBsb2FkKGZhbHNlLCBcIkNyZWF0ZVwiKTtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbmNvbnN0IHByZXZpZXdNb2RhbCA9IG5ldyBQb3B1cFdpdGhJbWFnZSh7XHJcbiAgbW9kYWxTZWxlY3RvcjogcHJldmlld0ltYWdlTW9kYWwsXHJcbn0pO1xyXG5cclxuY29uc3QgZGVsZXRlQ2FyZE1vZGFsID0gbmV3IFBvcHVwV2l0aENvbmZpcm0ocmVtb3ZlQ2FyZE1vZGFsKTtcclxuXHJcbmNvbnN0IGNoYW5nZUF2YXRhck1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oYXZhdGFyTW9kYWwsIChpbnB1dCkgPT4ge1xyXG4gIGNoYW5nZUF2YXRhck1vZGFsLnV4VXBsb2FkKHRydWUsIFwiU2F2aW5nLi4uXCIpO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRVc2VyQXZhdGFyKGlucHV0LmF2YXRhcilcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xyXG4gICAgICBjaGFuZ2VBdmF0YXJNb2RhbC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGNoYW5nZUF2YXRhck1vZGFsLnV4VXBsb2FkKGZhbHNlLCBcIlNhdmVcIik7XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG4vKiAgICAgICBDcmVhdGUgQ2FyZCAgICAgICAqL1xyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKG9iamVjdCkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIG9iamVjdCxcclxuICAgIHVzZXJJZCxcclxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICAgIChuYW1lLCBsaW5rKSA9PiB7XHJcbiAgICAgIHByZXZpZXdNb2RhbC5vcGVuKG5hbWUsIGxpbmspO1xyXG4gICAgfSxcclxuICAgIChjYXJkSWQpID0+IHtcclxuICAgICAgZGVsZXRlQ2FyZE1vZGFsLm9wZW4oKTtcclxuICAgICAgZGVsZXRlQ2FyZE1vZGFsLnN1Ym1pdEFjdGlvbigoKSA9PiB7XHJcbiAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLmNvbmZpcm1EZWxldGUodHJ1ZSk7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAuZGVsZXRlQ2FyZChjYXJkSWQpXHJcbiAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQuZGVsZXRlQ2FyZCgpO1xyXG4gICAgICAgICAgICBkZWxldGVDYXJkTW9kYWwuY2xvc2UoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKVxyXG4gICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBkZWxldGVDYXJkTW9kYWwuY29uZmlybURlbGV0ZShmYWxzZSwgXCJZZXNcIik7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgKGNhcmRJZCkgPT4ge1xyXG4gICAgICBpZiAoY2FyZC5pc0xpa2VkKCkpIHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5yZW1vdmVDYXJkTGlrZShjYXJkSWQpXHJcbiAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLnJlbW92ZUxpa2VzKCk7XHJcbiAgICAgICAgICAgIGNhcmQudXBkYXRlTGlrZXMoZGF0YSk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAuYWRkQ2FyZExpa2UoY2FyZElkKVxyXG4gICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgY2FyZC5hZGRMaWtlcygpO1xyXG4gICAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKGRhdGEpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgKTtcclxuICByZXR1cm4gY2FyZC5nZXRDYXJkRWxlbWVudCgpO1xyXG59XHJcblxyXG4vKiAgICAgIFJlbmRlciBDYXJkcyAgICAgICovXHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoZGF0YSkge1xyXG4gIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKGRhdGEpO1xyXG4gIGNhcmRBcGkucHJlcGVuZEl0ZW0oY2FyZCk7XHJcbn1cclxuXHJcbi8qICAgICAgIEFQSSBpbmZvICAgICAgKi9cclxuYXBpXHJcbiAgLmdldEFwaUluZm8oKVxyXG4gIC50aGVuKChbaW5pdGlhbGl6ZVVzZXIsIGluaXRpYWxpemVDYXJkc10pID0+IHtcclxuICAgIHVzZXJJZCA9IGluaXRpYWxpemVVc2VyLl9pZDtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGluaXRpYWxpemVVc2VyKTtcclxuXHJcbiAgICBjYXJkQXBpID0gbmV3IFNlY3Rpb24oXHJcbiAgICAgIHsgaXRlbTogaW5pdGlhbGl6ZUNhcmRzLCByZW5kZXJlcjogcmVuZGVyQ2FyZCB9LFxyXG4gICAgICBcIi5jYXJkc19fbGlzdFwiXHJcbiAgICApO1xyXG4gICAgY2FyZEFwaS5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XHJcblxyXG4vKiAgICAgICBGb3JtIFN1Ym1pdCBGdW5jdGlvbnMgICAgICAgKi9cclxuZnVuY3Rpb24gZmlsbFByb2ZpbGVGb3JtKCkge1xyXG4gIG1vZGFsVGl0bGUudmFsdWUgPSBwcm9maWxlVGl0bGUudGV4dENvbnRlbnQ7XHJcbiAgbW9kYWxEZXNjcmlwdGlvbi52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcclxufVxyXG5cclxuLyogICAgICBPcGVuIE1vZGFsIExpc3RlbmVycyAgICAgICAqL1xyXG5wcm9maWxlRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGZpbGxQcm9maWxlRm9ybSgpO1xyXG4gIGVkaXRQcm9maWxlTW9kYWwub3BlbigpO1xyXG59KTtcclxuYWRkQ2FyZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNhcmRBZGRNb2RhbC5vcGVuKCk7XHJcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxufSk7XHJcblxyXG5hdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY2hhbmdlQXZhdGFyTW9kYWwub3BlbigpO1xyXG4gIGF2YXRhckZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxufSk7XHJcblxyXG4vKiAgICAgIGNsb3NlIE1vZGFsIExpc3RlbmVycyAgICAgICAqL1xyXG5wcm9maWxlRWRpdE1vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgZWRpdFByb2ZpbGVNb2RhbC5jbG9zZSgpXHJcbik7XHJcblxyXG5hZGRNb2RhbENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjYXJkQWRkTW9kYWwuY2xvc2UoKSk7XHJcblxyXG5wcmV2aWV3SW1hZ2VDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gcHJldmlld01vZGFsLmNsb3NlKCkpO1xyXG5cclxuZGVsZXRlQ2FyZENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBkZWxldGVDYXJkTW9kYWwuY2xvc2UoKSk7XHJcblxyXG5hdmF0YXJNb2RhbENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjaGFuZ2VBdmF0YXJNb2RhbC5jbG9zZSgpKTtcclxuXHJcbi8qICAgICBFdmVudCBMaXN0ZW5lcnMgICAgICAqL1xyXG5lZGl0UHJvZmlsZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNhcmRBZGRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5wcmV2aWV3TW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuZGVsZXRlQ2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNoYW5nZUF2YXRhck1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vKiAgICAgIEZvcm0gVmFsaWRhdG9ycyAgICAgICAqL1xyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgcHJvZmlsZUVkaXRGb3JtKTtcclxuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGFkZENhcmRGb3JtKTtcclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgYXZhdGFyTW9kYWxGb3JtKTtcclxuXHJcbnByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuIiwiY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgYWJvdXQsIGF2YXRhciB9KSB7XHJcbiAgICB0aGlzLl91c2VyID0gbmFtZTtcclxuICAgIHRoaXMuX2Fib3V0ID0gYWJvdXQ7XHJcbiAgICB0aGlzLl9hdmF0YXIgPSBhdmF0YXI7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIGNvbnN0IHVzZXJEYXRhID0ge1xyXG4gICAgICBuYW1lOiB0aGlzLl91c2VyLnRleHRDb250ZW50LFxyXG4gICAgICBhYm91dDogdGhpcy5fYWJvdXQudGV4dENvbnRlbnQsXHJcbiAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyLFxyXG4gICAgfTtcclxuICAgIHJldHVybiB1c2VyRGF0YTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQsIGF2YXRhciB9KSB7XHJcbiAgICB0aGlzLl91c2VyLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gYWJvdXQ7XHJcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gYXZhdGFyO1xyXG4gICAgdGhpcy5fYXZhdGFyLmFsdCA9IG5hbWU7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBVc2VySW5mbztcclxuIiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9jaGVja1N0YXR1cyhyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrU3RhdHVzKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrU3RhdHVzKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXJQcm9maWxlKGlucHV0RGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGlucHV0RGF0YS50aXRsZSxcclxuICAgICAgICBhYm91dDogaW5wdXREYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tTdGF0dXMocmVzKSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckF2YXRhcihhdmF0YXIpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tTdGF0dXMocmVzKSk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1N0YXR1cyhyZXMpKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrU3RhdHVzKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgYWRkQ2FyZExpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrU3RhdHVzKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlQ2FyZExpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrU3RhdHVzKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgZ2V0QXBpSW5mbygpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBcGk7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBtb2RhbFNlbGVjdG9yIH0pIHtcclxuICAgIHN1cGVyKHsgbW9kYWxTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX21vZGFsSW1hZ2UgPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9tb2RhbENhcHRpb24gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcclxuICB9XHJcbiAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICB0aGlzLl9tb2RhbEltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9tb2RhbEltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9tb2RhbENhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoSW1hZ2U7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoQ29uZmlybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcih7IG1vZGFsU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9jb25maXJtQnV0dG9uID1cclxuICAgICAgdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLWJ0bi1zdWJtaXRcIik7XHJcbiAgfVxyXG5cclxuICBzdWJtaXRBY3Rpb24oYWN0aW9uKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBhY3Rpb247XHJcbiAgfVxyXG5cclxuICBjb25maXJtRGVsZXRlKGlzRGVsZXRlZCwgZGVsKSB7XHJcbiAgICBpZiAoaXNEZWxldGVkKSB7XHJcbiAgICAgIHRoaXMuX2NvbmZpcm1CdXR0b24udGV4dENvbnRlbnQgPSBcIkRlbGV0aW5nLi4uXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9jb25maXJtQnV0dG9uLnRleHRDb250ZW50ID0gZGVsO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoQ29uZmlybTtcclxuIiwiY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtLCByZW5kZXJlciB9LCBzZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xyXG4gIH1cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxuICBwcmVwZW5kSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFNlY3Rpb247XHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwidXNlcklkIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX293bmVySWQiLCJvd25lciIsIl9saWtlcyIsImxpa2VzIiwiX3VzZXJJZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsImRlbGV0ZUNhcmQiLCJfY2FyZEVsZW1lbnQiLCJyZW1vdmUiLCJhZGRMaWtlcyIsIl9saWtlQnRuIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlTGlrZXMiLCJ1cGRhdGVMaWtlcyIsIl9jYXJkTGlrZSIsInRleHRDb250ZW50IiwibGVuZ3RoIiwiaXNMaWtlZCIsImNvbnRhaW5zIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwicXVlcnlTZWxlY3RvciIsIl9kZWxldGVCdG4iLCJhZGRFdmVudExpc3RlbmVyIiwiX2NhcmRJbWdFbGVtZW50IiwiX2dldEVsZW1lbnQiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJnZXRDYXJkRWxlbWVudCIsIl90aXRsZUVsZW1lbnQiLCJzcmMiLCJhbHQiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfZm9ybVNlbGVjdG9yIiwiZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ0blNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdG5DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FTGVtZW50IiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImlucHV0RWxlbWVudCIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJfaGFzSW52YWxpZElucHV0IiwiX3NldEZvcm1FdmVudExpc3RlbmVycyIsIl9pbnB1dEVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdG4iLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJpbnB1dCIsIl9kaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwiZXZlcnkiLCJlcnJvckVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiZW5hYmxlVmFsaWRhdGlvbiIsIl9mb3JtRWxlbWVudHMiLCJlIiwicHJldmVudERlZmF1bHQiLCJwcm9maWxlRWRpdE1vZGFsIiwicHJvZmlsZUVkaXRGb3JtIiwiYWRkQ2FyZE1vZGFsIiwiYWRkQ2FyZEZvcm0iLCJwcmV2aWV3SW1hZ2VNb2RhbCIsInJlbW92ZUNhcmRNb2RhbCIsImF2YXRhck1vZGFsIiwiYXZhdGFyTW9kYWxGb3JtIiwicHJvZmlsZUVkaXRCdG4iLCJwcm9maWxlRWRpdE1vZGFsQ2xvc2VCdG4iLCJhZGRDYXJkQnRuIiwiYWRkTW9kYWxDbG9zZUJ0biIsInByb2ZpbGVUaXRsZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInByb2ZpbGVBdmF0YXIiLCJwcmV2aWV3SW1hZ2VDbG9zZUJ0biIsImRlbGV0ZUNhcmRDbG9zZUJ0biIsImF2YXRhckVkaXRCdXR0b24iLCJhdmF0YXJNb2RhbENsb3NlQnRuIiwibW9kYWxUaXRsZSIsIm1vZGFsRGVzY3JpcHRpb24iLCJfcmVmIiwibW9kYWxTZWxlY3RvciIsIl9tb2RhbEVsZW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwid2hpY2giLCJfaGFuZGxlT3ZlcmxheUNsb3NlIiwidGFyZ2V0Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJQb3B1cCIsImhhbmRsZVN1Ym1pdEZvcm0iLCJzdXBlciIsIl9tb2RhbEZvcm0iLCJfbW9kYWxTdWJtaXRCdG4iLCJfbW9kYWxJbnB1dHMiLCJfaGFuZGxlU3VibWl0Rm9ybSIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwidmFsdWUiLCJ1eFVwbG9hZCIsImlzVXBsb2FkIiwidXBsb2FkIiwicmVzZXQiLCJ1c2VySW5mbyIsImFib3V0IiwiYXZhdGFyIiwiX3VzZXIiLCJfYWJvdXQiLCJfYXZhdGFyIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VySW5mbyIsIl9yZWYyIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrU3RhdHVzIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImZldGNoIiwibWV0aG9kIiwidGhlbiIsImdldEluaXRpYWxDYXJkcyIsImVkaXRVc2VyUHJvZmlsZSIsImlucHV0RGF0YSIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImVkaXRVc2VyQXZhdGFyIiwiYWRkTmV3Q2FyZCIsImNhcmRJZCIsImFkZENhcmRMaWtlIiwicmVtb3ZlQ2FyZExpa2UiLCJnZXRBcGlJbmZvIiwiYWxsIiwiYXV0aG9yaXphdGlvbiIsImNhcmRBcGkiLCJlZGl0UHJvZmlsZU1vZGFsIiwiUG9wdXBXaXRoRm9ybSIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiZmluYWxseSIsImNhcmRBZGRNb2RhbCIsInJlbmRlckNhcmQiLCJwcmV2aWV3TW9kYWwiLCJfbW9kYWxJbWFnZSIsIl9tb2RhbENhcHRpb24iLCJkZWxldGVDYXJkTW9kYWwiLCJfY29uZmlybUJ1dHRvbiIsInN1Ym1pdEFjdGlvbiIsImFjdGlvbiIsIl9oYW5kbGVTdWJtaXQiLCJjb25maXJtRGVsZXRlIiwiaXNEZWxldGVkIiwiZGVsIiwiY2hhbmdlQXZhdGFyTW9kYWwiLCJjYXJkIiwib2JqZWN0IiwiY3JlYXRlQ2FyZCIsInByZXBlbmRJdGVtIiwiaW5pdGlhbGl6ZVVzZXIiLCJpbml0aWFsaXplQ2FyZHMiLCJzZWxlY3RvciIsIml0ZW0iLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsImFkZEl0ZW0iLCJlbGVtZW50IiwiYXBwZW5kIiwicHJlcGVuZCIsImFkZENhcmRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsInByb2ZpbGVGb3JtVmFsaWRhdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==